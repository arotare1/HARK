View(manuf_panel_preperiod)
names(manuf_panel_preperiod)[grep('t2', names(manuf_panel_preperiod))]
names(manuf_panel_preperiod)[grep('t2', names(manuf_panel_preperiod))] <- 't2000'
manuf_panel_preperiod$t1990 <- 1 - manuf_panel_preperiod$t2000
adh_china_preperiod <- read.dta('/Users/andreea/Documents/phd/itrade/project/adh2013_data/dta/workfile_china_preperiod.dta')
intersect(names(adh_china_preperiod), names(manuf_panel_preperiod))
manuf_panel_preperiod <- merge(manuf_panel_preperiod, adh_china_preperiod)
View(manuf_panel_preperiod)
source('~/Documents/phd/itrade/project/my_code/create_data.R')
summary(manuf_long$d_02_07_valadd)
quantile(manuf_panel_preperiod$d_valadd, probs=seq(0, 1, 0.02))
quantile(manuf_panel_preperiod$d_output, probs=seq(0, 1, 0.02))
quantile(manuf_panel$d_output, probs=seq(0, 1, 0.02))
quantile(manuf_panel$d_valadd, probs=seq(0, 1, 0.02))
quantile(manuf_long$d_92_07_valadd, probs=seq(0, 1, 0.02))
quantile(manuf_long$d_92_07_output, probs=seq(0, 1, 0.02))
length(which(manuf_panel_preperiod$d_valadd>242))
930-19
manuf_long <- read.csv('/Users/andreea/Documents/phd/itrade/project/my_data/manuf_long.csv')
manuf_panel <- read.csv('/Users/andreea/Documents/phd/itrade/project/my_data/manuf_panel.csv')
manuf_preperiod <- read.csv('/Users/andreea/Documents/phd/itrade/project/my_data/manuf_panel_preperiod.csv')
View(manuf_long)
quantile(manuf_long$d_02_07_valadd, probs=seq(0, 1, 0.25))
quantile(manuf_long$d_02_07_valadd, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_92_02_valadd, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_92_02_valadd, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_02_07_valadd, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_92_07_valadd, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_92_02_output, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_02_07_output, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_92_07_output, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
source('~/Documents/phd/itrade/project/my_code/descr_stats.R')
quantile(manuf_long$d_92_02_valadd, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_02_07_valadd, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_92_07_valadd, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
summary(manuf_long$d_92_02_valadd)
mean(manuf_long$d_92_02_valadd)
sd(manuf_long$d_92_02_valadd)
mean(manuf_long$d_02_07_valadd)
sd(manuf_long$d_02_07_valadd)
mean(manuf_long$d_92_07_valadd)
sd(manuf_long$d_92_07_valadd)
summary(manuf_long$d_92_02_valadd)
mean(manuf_long$d_92_02_output)
sd(manuf_long$d_92_02_output)
mean(manuf_long$d_02_07_output)
sd(manuf_long$d_02_07_output)
mean(manuf_long$d_92_07_output)
sd(manuf_long$d_92_07_output)
quantile(manuf_long$d_92_02_output, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_02_07_output, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_92_07_output, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
View(manuf_long)
quantile(manuf_long$d_92_02_valadd, probs=seq(0, 1, 0.02))
length(which(manuf_long$d_92_02_valadd<0))/length(manuf_long$d_92_02_output)*100
length(which(manuf_long$d_02_07_valadd<0))/length(manuf_long$d_92_02_output)*100
summary(manuf_long$d_92_02_valadd)
summary(manuf_long$d_02_07_valadd)
summary(manuf_long$d_02_07_valadd[which(manuf_long$d_92_02_valadd<0)])
summary(manuf_long$d_02_07_valadd[which(manuf_long$d_92_02_valadd>0)])
summary(manuf_long$d_02_07_output[which(manuf_long$d_92_02_output>0)])
summary(manuf_long$d_02_07_output[which(manuf_long$d_92_02_output<0)])
length(which(manuf_long$d_92_02_valadd<0))
length(which(manuf_long$d_92_02_output<0))
quantile(manuf_long$d_02_07_valadd[which(manuf_long$d_92_02_valadd>0)], probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
quantile(manuf_long$d_02_07_valadd[which(manuf_long$d_92_02_valadd<0)], probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
summary(manuf_long$d_02_07_valadd[which(manuf_long$d_92_02_valadd<0)])
mean(manuf_long$d_02_07_valadd[which(manuf_long$d_92_02_valadd<0)])
sd(manuf_long$d_02_07_valadd[which(manuf_long$d_92_02_valadd<0)])
quantile(manuf_long$d_02_07_output[which(manuf_long$d_92_02_output<0)], probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
mean(manuf_long$d_02_07_output[which(manuf_long$d_92_02_output<0)])
sd(manuf_long$d_02_07_output[which(manuf_long$d_92_02_output<0)])
quantile(manuf_long$d_92_02_output-manuf_long$d_92_02_valadd, probs=c(0.1, 0.25, 0.5, 0.75, 0.9))
library(foreign)
library(plyr)
library(ggplot2)
library(ggrepel)
setwd('/Users/andreea/Documents/phd/2ndyrpaper/HARK/cstwGrowth/Empirical')
#----------------------------------------------------------------------------
# Import inequality results from the model
# Specification: BetaDistPYnw
#----------------------------------------------------------------------------
model_agg <- read.csv('../Results/DistPYagg.csv')
model_agg <- model[, -1]
#----------------------------------------------------------------------------
# Import real GDP data from the World Bank
# https://data.worldbank.org/indicator/NY.GDP.MKTP.KD
#----------------------------------------------------------------------------
gdp_raw <- read.csv('./worldbank_gdp/API_NY.GDP.MKTP.KD_DS2_en_csv_v2.csv')
#----------------------------------------------------------------------------
# Import income group of each country from the World Bank
# https://data.worldbank.org/indicator/NY.GDP.MKTP.KD
#----------------------------------------------------------------------------
inc_group <- read.csv('./worldbank_gdp/Metadata_Country_API_NY.GDP.MKTP.KD_DS2_en_csv_v2.csv')
inc_group <- inc_group[, colnames(inc_group) %in% c('CountryCode', 'IncomeGroup', 'TableName')]
#-----------------------------------------------------------------
# Import OECD Wealth distribution database
# http://stats.oecd.org/viewhtml.aspx?datasetcode=WEALTH&lang=en#
#-----------------------------------------------------------------
oecd_wealth_raw <- read.csv('./oecd_wealth/WEALTH_22042018010501539.csv')
# Keep just mean to median net wealth and wealth shares of top 1%,5%,10%
oecd_wealth <- oecd_wealth_raw[sort(c(grep('Mean to median', oecd_wealth_raw$Variable),
grep('Share of top', oecd_wealth_raw$Variable),
grep('Share of bottom', oecd_wealth_raw$Variable))), ]
# Keep just latest year
oecd_wealth <- ddply(oecd_wealth, .(COUNTRY, VAR), summarise,
Country = Country[1],
Variable = Variable[1],
Year = max(TIME),
Value = Value[which(TIME==max(TIME))])
# Merge OECD inequality data with GDP data
oecd_wealth <- merge(oecd_wealth, gdp_raw, by.x='COUNTRY', by.y='CountryCode')
# For each country, compute the GDP growth over the 30 years prior to the latest inequality data
oecd_wealth <- adply(oecd_wealth, 1, function(row) {
gdp_last <- as.numeric(row[grep(as.character(row$Year), colnames(row))]) # get GDP in last year
gdp_last30 <- as.numeric(row[grep(as.character(row$Year - 30), colnames(row))]) # get GDP from 30 yrs before
gdp_growth <- (gdp_last/gdp_last30)^(1/30)-1 # get annualized growth rate
output <- data.frame(GDP_last=gdp_last, GDP_last30=gdp_last30, GDP_growth=gdp_growth)
return(output)
})
oecd_wealth <- oecd_wealth[, -grep('X', colnames(oecd_wealth))] # delete annual GDP observations
oecd_wealth <- oecd_wealth[, !(colnames(oecd_wealth) %in% c('CountryName',
'IndicatorName',
'IndicatorCode'))] # delete useless info
oecd_wealth <- oecd_wealth[complete.cases(oecd_wealth), ]
# Make dummy for whether country is in the group of 16 countries in Carroll's email
g16 <- c('DNK', 'CZE', 'NOR', 'FIN', 'SWE', 'HUN', 'DEU', 'LUX', 'CAN', 'AUS', 'ITA', 'NZL', 'JPN',
'GBR', 'ISR', 'USA')
oecd_wealth$g16 <- ifelse(oecd_wealth$COUNTRY %in% g16, 1, 0)
ggplot(oecd_wealth[oecd_wealth$VAR=='SB60',], aes(x=GDP_growth, y=Value/100)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Wealth share',
title='Wealth share of the bottom 60%')
plot(tmp$GDP_growth, tmp$Value/100, pch=16,
xlab='Annual GDP growth rate',
ylab='Wealth share',
main='Wealth share of the top 10%')
abline(lm(tmp$Value/100~tmp$GDP_growth), col='black', lwd=2)
lines(model_agg$Growth-1, model_agg$Bottom60_Lvl, type='o', pch=16, col='red', lwd=2)
legend('topright', legend=c('data', 'model'), col=c('black', 'red'), pch=16, ncol=2, cex=0.7)
tmp <- oecd_wealth[oecd_wealth$VAR=='SB60',]
plot(tmp$GDP_growth, tmp$Value/100, pch=16,
xlab='Annual GDP growth rate',
ylab='Wealth share',
main='Wealth share of the top 10%')
abline(lm(tmp$Value/100~tmp$GDP_growth), col='black', lwd=2)
lines(model_agg$Growth-1, model_agg$Bottom60_Lvl, type='o', pch=16, col='red', lwd=2)
legend('topright', legend=c('data', 'model'), col=c('black', 'red'), pch=16, ncol=2, cex=0.7)
source('~/Documents/phd/2ndyrpaper/HARK/cstwGrowth/Empirical/wealth_inequality.R')
source('~/Documents/phd/2ndyrpaper/HARK/cstwGrowth/Empirical/wealth_inequality.R')
ggplot(oecd_wealth[oecd_wealth$VAR=='M2MR',], aes(x=GDP_growth, y=Value)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Mean-to-median ratio of net wealth',
title='Mean-to-median ratio of net wealth')
pdf('m2m_data.pdf')
ggplot(oecd_wealth[oecd_wealth$VAR=='M2MR',], aes(x=GDP_growth, y=Value)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Mean-to-median ratio of net wealth',
title='Mean-to-median ratio of net wealth')
dev.off()
source('~/Documents/phd/2ndyrpaper/HARK/cstwGrowth/Empirical/wealth_inequality.R')
pdf('m2m_data.pdf')
ggplot(oecd_wealth[oecd_wealth$VAR=='M2MR',], aes(x=GDP_growth, y=Value)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Mean-to-median ratio of net wealth',
title='Mean-to-median ratio of net wealth')
dev.off()
tmp <- oecd_wealth[oecd_wealth$VAR=='M2MR',]
pdf('m2m_data_model.pdf')
plot(tmp$GDP_growth, tmp$Value, pch=16,
xlab='Annual GDP growth rate',
ylab='Mean-to-median ratio of net wealth',
main='Mean-to-median ratio of net wealth')
abline(lm(tmp$Value~tmp$GDP_growth), col='black', lwd=2)
lines(model_agg$Growth-1, model_agg$M2M_Lvl, type='o', pch=16, col='red', lwd=2)
legend('topright', legend=c('data', 'model'), col=c('black', 'red'), pch=16, ncol=2, cex=0.7)
dev.off()
pdf('top1_data.pdf')
ggplot(oecd_wealth[oecd_wealth$VAR=='ST1',], aes(x=GDP_growth, y=Value/100)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Wealth share',
title='Wealth share of the top 1%')
dev.off()
tmp <- oecd_wealth[oecd_wealth$VAR=='ST1',]
pdf('top1_data_model.pdf')
plot(tmp$GDP_growth, tmp$Value/100, pch=16,
xlab='Annual GDP growth rate',
ylab='Wealth share',
main='Wealth share of the top 1%')
abline(lm(tmp$Value/100~tmp$GDP_growth), col='black', lwd=2)
lines(model_agg$Growth-1, model_agg$Top1_Lvl, type='o', pch=16, col='red', lwd=2)
legend('topright', legend=c('data', 'model'), col=c('black', 'red'), pch=16, ncol=2, cex=0.7)
dev.off()
pdf('top5_data.pdf')
ggplot(oecd_wealth[oecd_wealth$VAR=='ST5',], aes(x=GDP_growth, y=Value/100)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Wealth share',
title='Wealth share of the top 5%')
dev.off()
tmp <- oecd_wealth[oecd_wealth$VAR=='ST5',]
pdf('top5_data_model.pdf')
plot(tmp$GDP_growth, tmp$Value/100, pch=16,
xlab='Annual GDP growth rate',
ylab='Wealth share',
main='Wealth share of the top 5%')
abline(lm(tmp$Value/100~tmp$GDP_growth), col='black', lwd=2)
lines(model_agg$Growth-1, model_agg$Top5_Lvl, type='o', pch=16, col='red', lwd=2)
legend('topright', legend=c('data', 'model'), col=c('black', 'red'), pch=16, ncol=2, cex=0.7)
dev.off()
pdf('top10_data.pdf')
ggplot(oecd_wealth[oecd_wealth$VAR=='ST10',], aes(x=GDP_growth, y=Value/100)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Wealth share',
title='Wealth share of the top 10%')
dev.off()
tmp <- oecd_wealth[oecd_wealth$VAR=='ST10',]
pdf('top10_data_model.pdf')
plot(tmp$GDP_growth, tmp$Value/100, pch=16,
xlab='Annual GDP growth rate',
ylab='Wealth share',
main='Wealth share of the top 10%')
abline(lm(tmp$Value/100~tmp$GDP_growth), col='black', lwd=2)
lines(model_agg$Growth-1, model_agg$Top10_Lvl, type='o', pch=16, col='red', lwd=2)
legend('topright', legend=c('data', 'model'), col=c('black', 'red'), pch=16, ncol=2, cex=0.7)
dev.off()
pdf('bot60_data.pdf')
ggplot(oecd_wealth[oecd_wealth$VAR=='SB60',], aes(x=GDP_growth, y=Value/100)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Wealth share',
title='Wealth share of the bottom 60%')
dev.off()
tmp <- oecd_wealth[oecd_wealth$VAR=='SB60',]
pdf('bot60_data_model.pdf')
plot(tmp$GDP_growth, tmp$Value/100, pch=16,
xlab='Annual GDP growth rate',
ylab='Wealth share',
main='Wealth share of the bottom 60%')
abline(lm(tmp$Value/100~tmp$GDP_growth), col='black', lwd=2)
lines(model_agg$Growth-1, model_agg$Bottom60_Lvl, type='o', pch=16, col='red', lwd=2)
legend('topright', legend=c('data', 'model'), col=c('black', 'red'), pch=16, ncol=2, cex=0.7)
dev.off()
View(wid_fr)
wid_gini <- read.csv('./wid_wealth/wid_gini/wealth-cn_fr_ru_usa.csv', header=FALSE)
us_dgini84_14 <- 0.859044206138 - 0.783020385217
fr_dgini84_14 <- 0.694574152428 - 0.642112571394
cn_dgini84_14 <- 0.749428254053 - 0.535917715168
ru_dgini95_14 <- 0.80940773114 - 0.666334643255
dginis <- c(us_dgini84_14, fr_dgini84_14, cn_dgini84_14, ru_dgini95_14)
View(gdp_raw)
gdp_raw[250, 5]
us_dgrowth <- (gdp_raw$X2014[250]/gdp_raw$X1984[250])^(1/30) - (gdp_raw$X1984[250]/gdp_raw$X1960[250])^(1/24)
fr_dgrowth <- (gdp_raw$X2014[76]/gdp_raw$X1984[76])^(1/30) - (gdp_raw$X1984[76]/gdp_raw$X1960[76])^(1/24)
getwd()
wid <- read.csv('/Users/andreea/Documents/phd/2ndyrpaper/HARK/cstwGrowth/Empirical/wid_wealth/wid_summary_21jan2018.csv')
wid <- wid[wid$Percentiles!='Macro variable (not applicable)',]
rm(wid)
wid_summary <- read.csv('/Users/andreea/Documents/phd/2ndyrpaper/HARK/cstwGrowth/Empirical/wid_wealth/wid_summary_21jan2018.csv')
View(wid_summary)
wid_summary <- wid_summary[wid_summary$Percentiles!='Macro variable (not applicable)',]
wid_summary <- wid_summary[grep('Wealth', wid_summary$Variable.category),]
wid_summary <- wid_summary[wid_summary$Short.name.of.variable=='Net personal wealth',]
wid_summary <- wid_summary[wid_summary$Type.s..of.variable=='Share',]
ggplot(oecd_wealth[oecd_wealth$VAR=='M2MR',], aes(x=GDP_growth, y=Value)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=TRUE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Mean-to-median ratio of net wealth',
title='Mean-to-median ratio of net wealth')
lm(M2MR~GDP_growth, data=oecd_wealth)
lm(Value~GDP_growth, data=oecd_wealth[oecd_wealth$VAR=='M2MR',])
summary(lm(Value~GDP_growth, data=oecd_wealth[oecd_wealth$VAR=='M2MR',]))
View(oecd_wealth_raw)
library(foreign)
library(plyr)
library(ggplot2)
library(ggrepel)
setwd('/Users/andreea/Documents/phd/2ndyrpaper/HARK/cstwGrowth/Empirical')
#----------------------------------------------------------------------------
# Import inequality results from the model
# Specification: BetaDistPYnw
#----------------------------------------------------------------------------
model_agg <- read.csv('../Results/DistPYagg.csv')
model_agg <- model_agg[, -1]
#----------------------------------------------------------------------------
# Import real GDP data from the World Bank
# https://data.worldbank.org/indicator/NY.GDP.MKTP.KD
#----------------------------------------------------------------------------
gdp_raw <- read.csv('./worldbank_gdp/API_NY.GDP.MKTP.KD_DS2_en_csv_v2.csv')
model_perm <- read.csv('../Results/DistPYperm.csv')
model_perm <- model_perm[, -1]
oecd_wealth_raw <- read.csv('./oecd_wealth/WEALTH_22042018010501539.csv')
oecd_wealth <- oecd_wealth_raw[sort(c(grep('Mean to median', oecd_wealth_raw$Variable),
grep('Share of top', oecd_wealth_raw$Variable),
grep('Median net wealth', oecd_wealth_raw$Variable),
grep('Share of bottom', oecd_wealth_raw$Variable))), ]
oecd_wealth <- ddply(oecd_wealth, .(COUNTRY, VAR), summarise,
Country = Country[1],
Variable = Variable[1],
Year = max(TIME),
Value = Value[which(TIME==max(TIME))])
View(oecd_wealth)
# Merge OECD inequality data with GDP data
oecd_wealth <- merge(oecd_wealth, gdp_raw, by.x='COUNTRY', by.y='CountryCode')
oecd_wealth <- adply(oecd_wealth, 1, function(row) {
gdp_last <- as.numeric(row[grep(as.character(row$Year), colnames(row))]) # get GDP in last year
gdp_last30 <- as.numeric(row[grep(as.character(row$Year - 30), colnames(row))]) # get GDP from 30 yrs before
gdp_growth <- (gdp_last/gdp_last30)^(1/30)-1 # get annualized growth rate
output <- data.frame(GDP_last=gdp_last, GDP_last30=gdp_last30, GDP_growth=gdp_growth)
return(output)
})
oecd_wealth <- oecd_wealth[, -grep('X', colnames(oecd_wealth))] # delete annual GDP observations
oecd_wealth <- oecd_wealth[, !(colnames(oecd_wealth) %in% c('CountryName',
'IndicatorName',
'IndicatorCode'))] # delete useless info
oecd_wealth <- oecd_wealth[complete.cases(oecd_wealth), ]
g16 <- c('DNK', 'CZE', 'NOR', 'FIN', 'SWE', 'HUN', 'DEU', 'LUX', 'CAN', 'AUS', 'ITA', 'NZL', 'JPN',
'GBR', 'ISR', 'USA')
oecd_wealth$g16 <- ifelse(oecd_wealth$COUNTRY %in% g16, 1, 0)
ggplot(oecd_wealth[oecd_wealth$VAR=='M2MR',], aes(x=GDP_growth, y=Value)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Mean-to-median ratio of net wealth',
title='Mean-to-median ratio of net wealth')
ggplot(oecd_wealth[oecd_wealth$VAR=='ST1',], aes(x=GDP_growth, y=Value/100)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Wealth share',
title='Wealth share of the top 1%')
ggplot(oecd_wealth[oecd_wealth$VAR=='ST5',], aes(x=GDP_growth, y=Value/100)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Wealth share',
title='Wealth share of the top 5%')
ggplot(oecd_wealth[oecd_wealth$VAR=='ST10',], aes(x=GDP_growth, y=Value/100)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Wealth share',
title='Wealth share of the top 10%')
ggplot(oecd_wealth[oecd_wealth$VAR=='SB60',], aes(x=GDP_growth, y=Value/100)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Wealth share',
title='Wealth share of the bottom 60%')
View(oecd_wealth)
library(foreign)
library(plyr)
library(ggplot2)
library(ggrepel)
setwd('/Users/andreea/Documents/phd/2ndyrpaper/HARK/cstwGrowth/Empirical')
#----------------------------------------------------------------------------
# Import inequality results from the model
# Specification: BetaDistPYnw
#----------------------------------------------------------------------------
model_agg <- read.csv('../Results/DistPYagg.csv')
model_agg <- model_agg[, -1]
model_perm <- read.csv('../Results/DistPYperm.csv')
model_perm <- model_perm[, -1]
#----------------------------------------------------------------------------
# Import real GDP data from the World Bank
# https://data.worldbank.org/indicator/NY.GDP.MKTP.KD
#----------------------------------------------------------------------------
gdp_raw <- read.csv('./worldbank_gdp/API_NY.GDP.MKTP.KD_DS2_en_csv_v2.csv')
#----------------------------------------------------------------------------
# Import income group of each country from the World Bank
# https://data.worldbank.org/indicator/NY.GDP.MKTP.KD
#----------------------------------------------------------------------------
inc_group <- read.csv('./worldbank_gdp/Metadata_Country_API_NY.GDP.MKTP.KD_DS2_en_csv_v2.csv')
inc_group <- inc_group[, colnames(inc_group) %in% c('CountryCode', 'IncomeGroup', 'TableName')]
#-----------------------------------------------------------------
# Import OECD Wealth distribution database
# http://stats.oecd.org/viewhtml.aspx?datasetcode=WEALTH&lang=en#
#-----------------------------------------------------------------
oecd_wealth_raw <- read.csv('./oecd_wealth/WEALTH_22042018010501539.csv')
# Keep just mean to median net wealth and wealth shares of top 1%,5%,10%
oecd_wealth <- oecd_wealth_raw[sort(c(grep('Mean to median', oecd_wealth_raw$Variable),
grep('Share of top', oecd_wealth_raw$Variable),
grep('Share of bottom', oecd_wealth_raw$Variable))), ]
# Keep just latest year
oecd_wealth <- ddply(oecd_wealth, .(COUNTRY, VAR), summarise,
Country = Country[1],
Variable = Variable[1],
Year = max(TIME),
Value = Value[which(TIME==max(TIME))])
# Merge OECD inequality data with GDP data
oecd_wealth <- merge(oecd_wealth, gdp_raw, by.x='COUNTRY', by.y='CountryCode')
# For each country, compute the GDP growth over the 30 years prior to the latest inequality data
oecd_wealth <- adply(oecd_wealth, 1, function(row) {
gdp_last <- as.numeric(row[grep(as.character(row$Year), colnames(row))]) # get GDP in last year
gdp_last30 <- as.numeric(row[grep(as.character(row$Year - 30), colnames(row))]) # get GDP from 30 yrs before
gdp_growth <- (gdp_last/gdp_last30)^(1/30)-1 # get annualized growth rate
output <- data.frame(GDP_last=gdp_last, GDP_last30=gdp_last30, GDP_growth=gdp_growth)
return(output)
})
oecd_wealth <- oecd_wealth[, -grep('X', colnames(oecd_wealth))] # delete annual GDP observations
oecd_wealth <- oecd_wealth[, !(colnames(oecd_wealth) %in% c('CountryName',
'IndicatorName',
'IndicatorCode'))] # delete useless info
oecd_wealth <- oecd_wealth[complete.cases(oecd_wealth), ]
# Make dummy for whether country is in the group of 16 countries in Carroll's email
g16 <- c('DNK', 'CZE', 'NOR', 'FIN', 'SWE', 'HUN', 'DEU', 'LUX', 'CAN', 'AUS', 'ITA', 'NZL', 'JPN',
'GBR', 'ISR', 'USA')
oecd_wealth$g16 <- ifelse(oecd_wealth$COUNTRY %in% g16, 1, 0)
# Compute ratio of bottom 90% to bottom 60%
View(oecd_wealth)
# Compute ratio of bottom 90% to bottom 60%
oecd_bot90 <- oecd_wealth[oecd_wealth$VAR=='SB60',]
View(oecd_bot90)
oecd_bot60 <- oecd_wealth[oecd_wealth$VAR=='SB60',]
View(oecd_bot60)
oecd_bot60 <- oecd_wealth[oecd_wealth$VAR=='SB60', colnames(oecd_wealth) %in% c('COUNTRY', 'VALUE')]
oecd_bot60 <- oecd_wealth[oecd_wealth$VAR=='SB60', colnames(oecd_wealth) %in% c('COUNTRY', 'Value')]
colnames(oecd_bot60)[2] <- 'SB60'
oecd_bot90 <- oecd_wealth[oecd_wealth$VAR=='ST10', colnames(oecd_wealth) %in% c('COUNTRY', 'Value')]
colnames(oecd_bot60)[2] <- 'SB90'
oecd_bot90 <- oecd_wealth[oecd_wealth$VAR=='ST10', colnames(oecd_wealth) %in% c('COUNTRY', 'Value')]
oecd_bot90$Value <- 100-oecd_bot90$Value
colnames(oecd_bot60)[2] <- 'SB90'
oecd_bot60 <- oecd_wealth[oecd_wealth$VAR=='SB60', colnames(oecd_wealth) %in% c('COUNTRY', 'Value')]
colnames(oecd_bot60)[2] <- 'SB60'
oecd_bot90 <- oecd_wealth[oecd_wealth$VAR=='ST10', colnames(oecd_wealth) %in% c('COUNTRY', 'Value')]
oecd_bot90$Value <- 100-oecd_bot90$Value
colnames(oecd_bot90)[2] <- 'SB90'
oecd_bot90_60 <- merge(oecd_bot90, oecd_bot60, by='COUNTRY')
View(oecd_bot90_60)
oecd_bot90_60$SB90_60 <- oecd_bot90_60$SB90 / oecd_bot90_60$SB60
?merge
oecd_bot90_60 <- merge(oecd_bot90_60, oecd_wealth[, colnames(oecd_wealth) %in% c('COUNTRY', 'GDP_growth')],
by='COUNTRY')
ggplot(oecd_bot90_60, aes(x=GDP_growth, y=SB90_60)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Bottom 90% / Bottom 60%',
title='Ratio of wealth shares of bottom 90% to bottom 60%')
# Compute ratio of bottom 90% to bottom 60%
oecd_bot60 <- oecd_wealth[oecd_wealth$VAR=='SB60', colnames(oecd_wealth) %in% c('COUNTRY', 'Value')]
oecd_bot60 <- oecd_wealth[oecd_wealth$VAR=='SB60', colnames(oecd_wealth) %in% c('COUNTRY', 'Value')]
colnames(oecd_bot60)[2] <- 'SB60'
oecd_bot90 <- oecd_wealth[oecd_wealth$VAR=='ST10', colnames(oecd_wealth) %in% c('COUNTRY', 'Value')]
oecd_bot90$Value <- 100-oecd_bot90$Value
colnames(oecd_bot90)[2] <- 'SB90'
oecd_bot90_60 <- merge(oecd_bot90, oecd_bot60, by='COUNTRY')
oecd_bot90_60$SB90_60 <- oecd_bot90_60$SB90 / oecd_bot90_60$SB60
oecd_ctrygrowth <- ddply(oecd_wealth, .(COUNTRY), summarise,
GDP_growth = GDP_growth[1])
View(oecd_ctrygrowth)
oecd_bot90_60 <- merge(oecd_bot90_60, oecd_ctrygrowth, by='COUNTRY')
ggplot(oecd_bot90_60, aes(x=GDP_growth, y=SB90_60)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Bottom 90% / Bottom 60%',
title='Ratio of wealth shares of bottom 90% to bottom 60%')
tmp <- oecd_wealth[oecd_wealth$VAR=='M2MR',]
pdf('m2m_data_model.pdf')
plot(tmp$GDP_growth, tmp$Value, pch=16,
xlab='Annual GDP growth rate',
ylab='Mean-to-median ratio of net worth',
main='Mean-to-median ratio of net worth')
abline(lm(tmp$Value~tmp$GDP_growth), col='black', lwd=2)
lines(model_agg$Growth-1, model_agg$M2M_Lvl, type='o', pch=16, col='red', lwd=2)
legend('topright', legend=c('data', 'model'), col=c('black', 'red'), pch=16, ncol=2, cex=0.7)
dev.off()
pdf('m2m_data.pdf')
ggplot(oecd_wealth[oecd_wealth$VAR=='M2MR',], aes(x=GDP_growth, y=Value)) +
geom_point() +
geom_label_repel(aes(label=COUNTRY)) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
theme_minimal() +
labs(x='Annual GDP growth rate', y='Mean-to-median ratio of net worth',
title='Mean-to-median ratio of net worth')
dev.off()
View(oecd_wealth)
lm(Value~GDP_growth, data=oecd_wealth[oecd_wealth$VAR=='M2MR',])
summary(lm(Value~GDP_growth, data=oecd_wealth[oecd_wealth$VAR=='M2MR',]))
